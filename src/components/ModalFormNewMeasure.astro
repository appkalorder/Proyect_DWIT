<div id="measurementModal" class="hidden fixed inset-0 z-50 overflow-y-auto backdrop-blur-sm">
    <!-- Overlay background -->
    <div class="fixed inset-0 bg-gray-500/30 transition-opacity"></div>
    
    <!-- Modal container -->
    <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="relative w-full max-w-md transform overflow-hidden rounded-lg bg-white/80 dark:bg-gray-800/90 shadow-xl transition-all backdrop-blur-md">
            <div class="p-6">
                <h3 class="text-lg font-medium leading-6 text-gray-900 dark:text-white">
                    AÃ±adir Nueva Medida
                </h3>
                <form class="mt-4">
                    <div class="grid gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Altura (cm)</label>
                            <input type="number" name="altura" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Peso (kg)</label>
                            <input type="number" name="peso" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Brazo Izquierdo (cm)</label>
                                <input type="number" name="brazo_izq" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Brazo Dererecho (cm)</label>
                                <input type="number" name="brazo_der" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Pierna Izquierda (cm)</label>
                                <input type="number" name="pierna_izq" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Pierna Derecha (cm)</label>
                                <input type="number" name="pierna_der" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Cadera (cm)</label>
                            <input type="number" name="cadera" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Pecho (cm)</label>
                            <input type="number" name="pecho" class="mt-1 py-1 px-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                    </div>
                    <div class="mt-5 flex justify-end gap-2">
                        <button type="button" id="closeModal" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 rounded-md">
                            Cancelar
                        </button>
                        <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 rounded-md">
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Get modal elements with null checks
    const modal = document.getElementById('measurementModal');
    const closeButton = document.getElementById('closeModal');
    const submitButton = document.querySelector('button[type="submit"]') as HTMLButtonElement;

    if (modal && closeButton && submitButton) {
        // Add event listeners for custom event
        window.addEventListener('openMeasurementModal', () => {
            console.log('Opening modal...'); // Debug log
            modal.classList.remove('hidden');
        });

        closeButton.addEventListener('click', () => {
            modal.classList.add('hidden');
        });

        // Close modal when clicking outside
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.add('hidden');
            }
        });

        // Handle form submission
        submitButton.addEventListener('click', (e) => {
            e.preventDefault();
            // Add your form submission logic here
            
            // Close modal after submission
            modal.classList.add('hidden');
        });
    }
</script>